# ETF量化助手桌面应用开发方案

## 一、项目概述

**项目名称**：ETF量化助手 (ETF Quant Assistant)
**目标用户**：具备Python基础、资金量较小、投资ETF为主的个人投资者
**核心价值**：将量化分析、LLM解释和可视化界面结合，提供每日明确的ETF操作建议

## 二、技术架构

### 2.1 技术栈选择

- **包管理**：uv（快速Python包管理器）
- **后端框架**：FastAPI（轻量级API框架）
- **前端技术**：HTML5 + CSS3 + Vanilla JS（避免复杂框架依赖）
- **数据存储**：SQLite（轻量级本地数据库）
- **图表库**：ECharts（开源可视化库）
- **量化计算**：Pandas + NumPy + TA-Lib（技术指标计算）
- **数据源**：akshare（免费金融数据）

### 2.2 应用架构

```text
├── 用户界面层
│   ├── 基金列表管理
│   ├── 策略展示面板
│   └── 历史数据图表
├── 业务逻辑层 (Python后端)
│   ├── 策略引擎
│   ├── LLM解释器
│   └── 数据管理器
└── 数据层
    ├── SQLite数据库
    └── 缓存文件
```

## 三、功能模块设计

### 3.1 ETF管理模块

- **基金添加**：输入ETF代码（如510300），自动获取基金名称、类型
- **基金列表**：显示自选ETF，包含实时涨跌幅、最新净值
- **持仓配置**：为每只ETF设置资金比例、风险等级
- **数据同步**：定时/手动更新基金数据

### 3.2 策略分析模块

- **多策略并行**：每只ETF运行3-5个简单策略（双均线、RSI、布林带）
- **信号生成**：策略投票机制，综合生成当日建议（买/卖/持）
- **仓位计算**：基于资金量、风险偏好计算具体买卖金额
- **LLM修饰**：将量化信号转化为自然语言建议

### 3.3 LLM解释模块

- **信号解释**：将技术指标转化为通俗易懂的投资逻辑
- **风险提示**：基于市场环境生成个性化风险警示
- **决策摘要**：生成50-100字的操作摘要
- **缓存机制**：相同信号避免重复调用LLM API

### 3.4 可视化模块

- **分时走势图**：当日价格与成交量变化
- **历史走势图**：近6个月价格趋势与技术指标叠加
- **策略回测图**：展示策略历史表现
- **信号时间轴**：历史买卖点标记

### 3.5 数据管理模块

- **本地缓存**：基金历史数据本地存储，减少API调用
- **策略记录**：保存每日生成的策略建议和实际结果
- **绩效跟踪**：记录手动执行情况与策略效果对比

## 四、界面设计方案

### 4.1 主界面布局

```text
+---------------------------------------------------+
|  ETF量化助手                    [设置] [刷新]    |
+------------------+--------------------------------+
|                  |                                |
|  自选ETF列表     |     主内容区                   |
|                  |                                |
|  +------------+  |  1. 当前选中的ETF分析         |
|  | 510300     |  |     - 分时图                  |
|  | 沪深300    |  |     - 6个月走势              |
|  | +2.3%      |  |                                |
|  +------------+  |  2. 当日策略建议              |
|  | 512880     |  |     - LLM修饰的决策          |
|  | 证券ETF    |  |     - 具体操作指令           |
|  | -1.1%      |  |                                |
|  +------------+  |  3. 历史策略回顾              |
|  [添加ETF]       |     - 日期选择器             |
|                  |     - 历史信号列表           |
+------------------+--------------------------------+
```

### 4.2 主要界面组件

1. **ETF列表面板**（左侧25%宽度）
   - 可滚动的ETF卡片列表
   - 每个卡片显示：代码、简称、涨跌幅、操作按钮
   - 底部添加ETF输入框

2. **图表展示区**（主区域上部50%）
   - 选项卡切换：分时图 / 近6月走势
   - 技术指标叠加选项（MA、MACD等）
   - 交互式图表（缩放、平移）

3. **策略建议区**（主区域中部30%）
   - 当日策略卡片：清晰的操作指令（"买入300元"）
   - LLM解释框：策略逻辑和风险提示
   - 一键复制指令到支付宝搜索

4. **历史策略区**（主区域下部20%）
   - 日期选择器
   - 历史策略表格：日期、策略、结果、备注
   - 策略有效性统计

## 五、数据流程设计

### 5.1 每日分析流程

```text
1. 数据获取 → 2. 策略计算 → 3. 信号整合 → 4. LLM修饰 → 5. 界面展示
```

### 5.2 数据存储结构

```sql
-- ETF基本信息表
CREATE TABLE etf_funds (
    code TEXT PRIMARY KEY,      -- ETF代码
    name TEXT,                  -- 基金名称
    added_date DATE,            -- 添加日期
    config JSON                 -- 配置（资金比例、策略参数等）
);

-- 每日策略记录表
CREATE TABLE daily_strategies (
    id INTEGER PRIMARY KEY,
    etf_code TEXT,              -- ETF代码
    date DATE,                  -- 策略日期
    raw_signal TEXT,            -- 原始信号
    llm_advice TEXT,            -- LLM修饰建议
    action_type TEXT,           -- 操作类型
    suggested_amount REAL,      -- 建议金额
    actual_action TEXT,         -- 用户实际执行
    created_at TIMESTAMP
);

-- 历史价格数据表
CREATE TABLE price_history (
    etf_code TEXT,
    date DATE,
    open REAL,
    close REAL,
    high REAL,
    low REAL,
    volume REAL,
    PRIMARY KEY (etf_code, date)
);
```

## 六、开发实施计划

### 6.1 第一阶段：基础框架（1-2周）

1. 实现基础界面布局
2. 集成uv包管理
3. 创建SQLite数据库结构

### 6.2 第二阶段：核心功能（2-3周）

1. 实现akshare数据获取与缓存
2. 开发量化策略引擎（3个基础策略）
3. 集成LLM API调用（DeepSeek/OpenAI）
4. 实现ECharts图表展示

### 6.3 第三阶段：交互优化（1-2周）

1. 完善用户交互流程
2. 添加数据本地缓存
3. 实现策略历史查看
4. 优化界面响应速度

### 6.4 第四阶段：测试部署（1周）

1. 策略回测验证
2. 用户界面测试
3. 打包为可执行文件
4. 编写用户手册

## 七、风险与限制说明

### 7.1 技术限制

- **数据延迟**：免费数据源可能存在15分钟延迟
- **LLM成本**：API调用产生费用（预计每月5-20元）
- **策略局限性**：简单策略无法适应所有市场环境
- **执行偏差**：手动执行与信号生成有时间差

### 7.2 使用建议

1. **小额试运行**：先用模拟或极小资金运行1-2个月
2. **双重验证**：将LLM建议与自己的判断结合
3. **定期回顾**：每周检查策略有效性，必要时调整参数
4. **风险控制**：设置单日最大亏损限额（如总资金2%）

## 八、项目扩展可能性

### 8.1 短期扩展

- 添加更多技术指标策略
- 支持多种LLM提供商切换
- 增加支付宝交易记录导入

### 8.2 长期扩展

- 接入实时数据推送
- 开发移动端配套应用
- 实现简单的自动交易执行（需券商API）

## 九、运行环境

- uv请使用uv sync命令同步依赖
- 使用uv add命令添加依赖
- 使用uv run命令运行项目